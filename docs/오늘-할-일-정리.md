# 오늘 뭐 해야 할지 — 정리

> `docs/` 내 `.md` 문서(01·03·04·05·10·11)를 기준으로 **오늘 할 일**을 우선순위·순서대로 정리한 요약본입니다.  
> **마지막 업데이트:** 2026년 2월 25일

---

## 🔔 리마인드: Meta·Google 심사 (배포용)

- **Meta:** 앱 검수 제출함 (Ads Management Standard Access, ads_read, ads_management, pages_show_list, pages_read_engagement 등). 비즈니스 인증은 검토 중.
- **Google:** Google Ads API 기본 액세스(토큰) 신청 제출함.
- **할 일:** 심사 결과가 나오면(이메일·대시보드 알림) **결과 알려주기** → 통과 시 실제 고객 연동 가능, 거절 시 수정 후 재제출.
- **리마인드:** "체크되는 대로 알려줄게" 하셨으니, **심사 결과가 나오면 이 문서의 아래 '내일 이어서 할 일'과 표 상태를 업데이트**해 두시면 다음에 이어서 진행하기 좋습니다.
- **문서:** Meta 앱 검수 → `05-플랫폼-연동-셋업-가이드.md`, Google → `Google-Ads-API-토큰-신청-답변-정리.md`, `12-Meta-Google-값-받아오기-테스트.md`

---

## 📌 오늘 할 일 요약 (한눈에)

| 순서 | 항목 | 상태 |
|------|------|------|
| 1 | Supabase placeholder 콘솔 에러 해결 | [x] (next.config loadEnvConfig 적용) |
| 2 | 원마케팅SaaS 폴더에서 `npm run dev` 실행 (`.next` 삭제 후 재실행) | [x] |
| 3 | 로그인 시 Failed to fetch / your-project 오류 없음 확인 | [x] |
| 4 | Auth 사용자 생성 + `profiles.sql` 실행 | [x] |
| 5 | Admin·테스트 계정 로그인 및 화면 확인 | [x] (yeomjw0907@naver.com, jgsos2222@naver.com 등) |
| 6 | Meta·Google 값 받아오기 테스트 (개발/테스트 모드) | [x] (Meta 동기화 완료, Google OAuth Client ID 오타 수정 반영) |
| 7 | 플랫폼 연동 환경·마이그레이션 점검 | [x] |
| 8 | Meta·Google **실제 배포용** 심사 제출 | [x] (제출 완료 → 결과 대기 중, 위 리마인드 참고) |

---

## 🔴 1. 로그인·Supabase (최우선)

로그인이 되지 않으면 다른 작업을 진행할 수 없습니다.

### 1-1. Supabase "설정이 없거나 placeholder" 콘솔 에러 해결

- **증상:** 로그인 페이지/버튼 시 콘솔에  
  `[Supabase] .env.local에 실제 Supabase URL과 Anon Key를 넣은 뒤...`  
  → `isSupabaseConfigured()`가 false로 인식됨.
- **할 일:**
  - 클라이언트 번들에 `NEXT_PUBLIC_*` 값이 왜 안 들어가는지 확인 (Next 빌드/캐시, 실행 경로).
  - 필요 시 `src/lib/supabase/client.ts`에서 값을 읽는 방식 변경 또는 브라우저에 URL/Key 전달 방식 수정.
- **참고:** `03-내일-할-일.md` 2번.

### 1-2. 개발 서버 올바른 폴더에서 실행

- **반드시** 프로젝트 폴더에서만 실행:
  ```powershell
  cd "C:\Users\yeomj\OneDrive\Desktop\원마케팅SaaS"
  npm run dev
  ```
- `.next` 폴더가 있으면 삭제 후 재실행:  
  `Remove-Item -Recurse -Force .next`
- `.env.local`에 **실제** Supabase URL·Anon Key가 들어 있어야 함 (placeholder 사용 금지).

### 1-3. 로그인 "Failed to fetch" 해결

- 1-1, 1-2 완료 후에도 `your-project.supabase.co` / `ERR_NAME_NOT_RESOLVED` 또는 `Failed to fetch` 나오면:
  - dev 서버 완전 종료 → 원마케팅SaaS 폴더에서만 `npm run dev` → 브라우저에서 `http://localhost:3000` 로그인 재시도.

---

## 🟠 2. Auth·프로필 재설정 (회원 정보 정리)

로그인 가능해지면, 사용 계정을 정리합니다.

| 용도 | 이메일 | UUID (문서) | 비고 |
|------|--------|-------------|------|
| Admin | yeomjw0907@naver.com | 9b54abfa-7692-48a3-804d-bec6b977181d | 프로필 반영됨 |
| 테스트(클라이언트) | test1@naver.com | 90f44f4a-7b9f-4866-99d8-b1e03203196e | Auth 실제 UUID, 성신컴퍼니로 프로필 반영됨 |

**순서:**

1. Supabase Dashboard → **Authentication** → **Users**  
   - 필요 시 기존 사용자 정리 후, 위 두 이메일로 **Create new user** (비밀번호 설정).
2. SQL Editor에서 **`supabase/sql/03-seed/profiles.sql`** 전체 붙여넣고 **Run**.

**참고:** `01-먼저-할-일.md` 5·6번.

---

## 🟡 3. 로그인·화면 확인

- **Admin:** `yeomjw0907@naver.com` + 비밀번호 → `/admin` 이동 확인.
- **테스트(클라이언트):** `test1@naver.com` + 비밀번호 → `/overview` 이동 확인.

---

## 🟢 4. Meta·Google 값 받아오기 테스트 (진행 순서)

**요약:** Meta(페이스북/인스타 광고)·Google(Ads/GA4)에서 데이터를 실제로 받아오는지 테스트하려면 아래 순서로 진행하면 됩니다.

1. **사전 준비**  
   - `.env.local`에 Meta(`META_APP_ID`, `META_APP_SECRET`), Google(`GOOGLE_CLIENT_ID`, `GOOGLE_CLIENT_SECRET`) 설정  
   - Meta/Google OAuth 앱에서 리디렉션 URI `http://localhost:3000/api/auth/meta/callback`, `.../api/auth/google/callback` 등록
2. **관리자에서 연동**  
   - 관리자 로그인 → **클라이언트** → 테스트 클라이언트(예: 성신컴퍼니) → **데이터 연동** 탭  
   - **Meta OAuth** 또는 **Google OAuth** 버튼으로 인증 후, 광고 계정 ID / Customer ID·Property ID 등 입력 → **연동 저장**
3. **값 받아오기 테스트**  
   - 같은 탭에서 **🔄 수동 동기화** 클릭 → 완료 후 Supabase `platform_metrics` 또는 동기화 로그로 데이터 유입 확인

**상세 단계·트러블슈팅:** **`12-Meta-Google-값-받아오기-테스트.md`** (신규 문서)

---

## 🟢 4-참고. Meta OAuth 연동 이어하기 (로그인 정리 후)

로그인과 프로필이 안정되면 데이터 연동을 진행합니다.

1. `npm run dev` → `http://localhost:3000`
2. 관리자 로그인 → **클라이언트** → 테스트 클라이언트(예: 성신컴퍼니) 선택
3. **데이터 연동** 탭 → **Meta OAuth** 클릭
4. App ID 입력 창이 뜨면 `.env.local`의 `META_APP_ID` 입력
5. Facebook **다시 연결** 후 돌아오면 **광고 계정 ID** 입력(예: `act_123456789`) → **연동 저장**
6. **🔄 수동 동기화**로 데이터 수집 테스트

**자세한 순서·확인 사항:** `10-Meta-OAuth-이어하기.md`

---

## 🔵 5. (선택) 플랫폼 연동 환경 점검

- `.env.local`에 플랫폼용 변수 있는지 확인:  
  `NEXT_PUBLIC_APP_URL`, `CRON_SECRET`, `META_APP_ID`, `META_APP_SECRET`, `GOOGLE_CLIENT_ID`, `GOOGLE_CLIENT_SECRET`, `GEMINI_API_KEY`  
  → `05-플랫폼-연동-셋업-가이드.md` 1절 참고.
- Supabase에 `001-add-contact-fields.sql` 등 마이그레이션 실행 여부 확인 → `05-플랫폼-연동-셋업-가이드.md` 2절.

---

## ⚙️ 참고: Windows EPERM 발생 시

`npm run dev` 시 **EPERM: operation not permitted, open '.next\trace'** 나오면:

- `npm run dev:safe` 또는 `npm run clean` 후 `npm run dev`
- 또는 `11-Windows-EPERM-트러블슈팅.md` 참고 (OneDrive 밖으로 프로젝트 이동 등).

---

## ✅ 오늘(최근) 완료한 작업 (2026-02-24 기준)

- **Meta 연동:** 동기화 완료 확인 (캠페인 꺼져 있어 0건 수집은 정상).
- **Google OAuth:** Client ID 오타 수정 (`6oeu6o15gn1` 영문 o 유지, `.env.local`·연동 기본설정과 동일하게 맞춤).
- **동기화 UI:** 관리자 데이터 연동 탭에 "자동 동기화: 매일 06:00 (KST)" 표시, 포털 마케팅 성과 페이지에 "데이터 동기화" 버튼·마지막 동기화 시간 표시, 포털용 동기화 API 추가.
- **푸터 법적 고지:** 개인정보 처리방침·이용약관·서비스 이용약관 링크 추가, 클릭 시 모달로 전문 표시. `src/content/legal.ts`에 서비스에 맞게 완결본 작성.
- **비밀번호 리셋:** Supabase 약한 비밀번호 에러 시 한글 안내 메시지로 대체. Supabase에서 검사 해제 방법은 `14-Supabase-비밀번호-검사-해제.md` 참고.
- **Google Ads API:** 토큰 신청 답변 정리·설계 문서(영문) 작성. 테스트 계정 토큰은 `.env.local`·Vercel에 설정 완료.
- **Meta 앱 검수:** 권한(ads_read, ads_management, Ads Management Standard Access, pages_* 등) 제출, 비즈니스 인증 검토 중. **→ 심사 결과 나오면 알려주기(리마인드).**
- **Google Ads API:** 기본 액세스 신청 제출 완료. **→ 심사 결과 나오면 알려주기(리마인드).**
- **회원가입 후 페이지 오류:** 가입 완료 후 리다이렉트 시 `profiles`의 `company_name` 스키마 캐시 오류 해결. 미들웨어·getSession에서 `select("*")` 대신 필요한 컬럼만 명시해 조회하도록 수정.

---

## 📋 내일 이어서 할 일

1. **Meta·Google 심사 결과 확인**  
   - 이메일·대시보드 알림 확인 후, 통과 시 실제 고객 계정 연동 테스트. 거절 시 수정 사항 반영 후 재제출.
2. **비즈니스 인증(Meta)**  
   - 검토 완료되면 앱 검수 진행 상황 확인.
3. **회원가입·승인 플로우 검증**  
   - 새 계정으로 가입 → 승인 대기(/pending) → 관리자 `/admin/signups`에서 승인/거절 → 클라이언트 로그인 후 포털 접근까지 한 번 더 확인.
4. **(선택)** Supabase 스키마 캐시 갱신 후 `getSession`에서 `company_name`, `phone` 다시 select에 포함해 보기(SQL Editor에서 `NOTIFY pgrst, 'reload schema';` 실행 후 테스트).
5. **(선택)** Google OAuth 로컬 재테스트, Supabase 비밀번호 검사 해제 후 관리자 비밀번호 리셋 재확인.
6. **(선택)** 페이지 인사이트·인스타/페이스북 게시글 등은 심사 통과 후 별도 단계로 진행.

---

## 📚 참고 문서 목록

| 문서 | 용도 |
|------|------|
| `00-목차.md` | 문서 인덱스 |
| `01-먼저-할-일.md` | 첫 설정 체크리스트 (Supabase, Auth, 앱 실행) |
| `03-내일-할-일.md` | 로그인 해결, Auth·프로필 재설정 |
| `04-오늘-할-일.md` | 오늘 할 일 상세 체크리스트 (원본) |
| `05-플랫폼-연동-셋업-가이드.md` | 플랫폼 데이터 연동 셋업 (Meta, GA 등) |
| `10-Meta-OAuth-이어하기.md` | Meta OAuth 연동 순서·트러블슈팅 |
| `11-Windows-EPERM-트러블슈팅.md` | Windows EPERM(.next/trace) 해결 |
| `12-Meta-Google-값-받아오기-테스트.md` | Meta·Google에서 값 받아오기 테스트 순서·체크리스트 |
| `13-연동-설정-체크리스트.md` | 네이버/Meta/GA4/Google Ads 연동 설정·입력값·테스트 순서 체크리스트 |
| `14-Supabase-비밀번호-검사-해제.md` | 관리자 비밀번호 리셋 시 Supabase 유출 비밀번호 검사 해제 방법 |
| `Google-Ads-API-토큰-신청-답변-정리.md` | Google Ads API 토큰 신청 폼 답변 정리 |

---

---

## 🤖 AI/MCP로 해결 가능한 항목 (요약)

| 항목 | 가능 여부 | 비고 |
|------|-----------|------|
| **1-1 Supabase placeholder 에러** | ✅ 완료 | next.config에서 `loadEnvConfig`로 프로젝트 루트 `.env.local` 명시 로드 적용함. |
| **2. profiles.sql 실행** | ✅ 완료 | MCP로 실행 완료. test1@naver.com은 Auth UUID가 문서와 달라 실제 UUID(90f44f4a-…)·실제 client(성신컴퍼니)로 반영함. |
| **5. 플랫폼 연동 점검** | ✅ 확인 완료 | DB에 `001-add-contact-fields` 내용 이미 반영됨(clients 담당자 컬럼, data_integrations, platform_metrics 등 존재). env 변수는 `05-플랫폼-연동-셋업-가이드.md` 1절 체크리스트 참고. |
| 1-2, 1-3 개발 서버 실행·Failed to fetch | ❌ 사용자 실행 | 폴더에서 `npm run dev`, 브라우저 확인 필요. |
| 2. Auth 사용자 생성 | ❌ Dashboard 수동 | Supabase MCP에는 사용자 생성 툴 없음 → Dashboard → Authentication → Users에서 생성. |
| 3. 로그인·화면 확인 | ⚠️ 선택 | 브라우저 MCP로 자동 로그인·스냅샷 테스트 가능(원하면 요청). |
| 4. Meta OAuth | ❌ 수동 | Facebook 연동·광고 계정 ID 입력은 사용자 진행. |

### ✅ 오늘 AI가 실행한 작업 (요약)

- **1-1**: next.config.mjs에 `loadEnvConfig` 적용 완료 (이전 세션).
- **7번**: Supabase MCP로 DB 테이블·마이그레이션 확인 완료.
- **profiles.sql**: MCP로 실행 완료. Admin(yeomjw0907@naver.com)·테스트(test1@naver.com) 프로필 등록됨. test1은 Auth UUID·client_id를 실제 DB(성신컴퍼니) 기준으로 반영함.

---

*이 파일은 `docs/` 내 기존 .md 문서를 바탕으로 오늘 할 일만 모아 정리한 요약입니다. 상세 내용은 각 문서를 참고하세요.*
