# 카카오 알림톡 · 솔라피 설정 체크리스트

알림톡을 쓰려면 **솔라피(Solapi)** 와 **카카오 비즈니스 채널** 관리자에서 아래 작업을 해 두어야 합니다.  
코드에 넣을 값(.env)은 여기서 확인한 값으로 채우면 됩니다.

---

## 1. 솔라피(Solapi) 쪽에서 할 일

**사이트:** https://solapi.com (또는 https://console.solapi.com)

| 순서 | 할 일 | 확인 |
|------|--------|------|
| 1 | **회원가입/로그인** | |
| 2 | **API 키 발급** · 마이페이지(또는 API 설정) → **API 키 관리** → **API Key**, **API Secret** 발급/복사 | → `.env.local` 의 `SOLAPI_API_KEY`, `SOLAPI_API_SECRET` 에 넣기 |
| 3 | **카카오톡 채널 연동** · (솔라피에서 카카오 알림톡/채널 연동 메뉴) 카카오 비즈니스 채널과 연동 | 아래 "카카오 채널" 단계 먼저 한 뒤 진행 |
| 4 | 연동 후 **프로필 ID(PFID)** 확인 (예: `@onecation` 형태) | → `.env.local` 의 `SOLAPI_PFID` 에 넣기 |
| 5 | **(선택) 발신번호 등록** · 알림톡 실패 시 SMS 대체 발송을 쓰려면 발신번호 등록 | → `.env.local` 의 `SOLAPI_SENDER_NUMBER` 에 넣기 |

- API Secret은 **발급 시 한 번만** 보이므로 안전하게 보관하세요.

---

## 2. 카카오 비즈니스 채널(관리자) 쪽에서 할 일

**사이트:** https://business.kakao.com (또는 카카오 비즈니스 채널 관리자)

| 순서 | 할 일 | 확인 |
|------|--------|------|
| 1 | **채널 생성** · 비즈니스 채널 가입 후 채널 1개 생성 | |
| 2 | **솔라피와 연동** · 채널 설정에서 메시지 발송 수단으로 솔라피 연동 (솔라피 안내에 따라 진행) | 연동 후 솔라피에서 PFID 확인 가능 |
| 3 | **알림톡 템플릿 등록** · 아래 표의 **템플릿 ID**를 **그대로** 사용해서 채널에 메시지 템플릿 등록·승인 | 템플릿 ID 오타 없이 동일하게 |

→ **템플릿 문구·변수·버튼 예시**는 **[카카오-알림톡-템플릿-등록-예시.md](./카카오-알림톡-템플릿-등록-예시.md)** 에 정리해 두었습니다. 복사해서 등록하면 됩니다.

---

## 3. 등록해야 하는 알림톡 템플릿 (카카오 채널에 ID·변수 맞춰 등록)

앱에서 쓰는 템플릿 ID는 `src/lib/notifications/alimtalk.ts` 의 `TEMPLATE_IDS` 와 **완전히 동일**해야 합니다.  
카카오 채널에서 아래 **템플릿 코드(ID)** 를 그대로 넣고, **치환 변수**도 아래와 맞춰 등록하세요.

| 템플릿 코드 (ID) | 용도 | 치환 변수 (카카오에 등록할 이름) |
|------------------|------|----------------------------------|
| `TPL_report_published` | 보고서 발행 알림 | `#{고객명}`, `#{리포트제목}`, `#{링크}` |
| `TPL_action_status` | 실행항목 상태 변경 | `#{고객명}`, `#{작업명}`, `#{이전상태}`, `#{현재상태}` |
| `TPL_event_reminder` | 일정 리마인더 | `#{고객명}`, `#{일정명}`, `#{날짜}` |
| `TPL_password_reset` | 비밀번호 리셋 안내 | (코드 내 사용처에 맞게 변수 정의) |
| `TPL_mon_review` | 월요일 지난주 성과 리뷰 | `#{고객명}`, `#{요약}`, `#{자세히보기}` |
| `TPL_wed_budget` | 수요일 예산 페이싱 | `#{고객명}`, `#{요약}`, `#{자세히보기}` |
| `TPL_thu_proposal` | 목요일 다음 주 제안 + 승인 | `#{고객명}`, `#{요약}`, `#{자세히보기}`, `#{승인하기}` |
| `TPL_addon_order_admin` | 부가서비스 주문 접수 (관리자 수신) | `#{고객명}`, `#{서비스명}`, `#{금액}`, `#{링크}` |

- 템플릿 내용(문구)은 서비스에 맞게 작성하면 되고, **템플릿 코드(ID)** 와 **변수 이름**만 위와 같게 맞추면 됩니다.
- 카카오에서 템플릿 승인 후에만 발송 가능합니다.

---

## 4. .env.local 에 넣을 값 요약

| 변수명 | 어디서 확인 | 비고 |
|--------|-------------|------|
| `SOLAPI_API_KEY` | 솔라피 마이페이지 → API 키 관리 | 필수 |
| `SOLAPI_API_SECRET` | 같은 화면 (발급 시 한 번만 표시) | 필수 |
| `SOLAPI_PFID` | 카카오 채널 연동 후 솔라피에서 확인 (예: @onecation) | 필수 |
| `SOLAPI_SENDER_NUMBER` | 솔라피 발신번호 등록 후 | 선택, SMS 대체용 |
| `ADMIN_NOTIFY_PHONE` | 직접 지정 (부가주문 알림 받을 관리자 번호) | 선택, 부가주문 알림톡 수신용 |

---

## 5. 체크리스트 한 줄 요약

- [ ] 솔라피 가입 후 API Key / API Secret 발급 → `.env` 에 입력
- [ ] 카카오 비즈니스 채널 생성 후 솔라피와 연동 → PFID 확인 → `.env` 의 `SOLAPI_PFID` 입력
- [ ] 카카오 채널에 위 표의 **템플릿 코드 8개** 동일하게 등록·승인 (변수명 일치)
- [ ] (선택) 솔라피 발신번호 등록 → `SOLAPI_SENDER_NUMBER` 입력
- [ ] (선택) 부가주문 알림 받을 번호 → `ADMIN_NOTIFY_PHONE` 입력
- [ ] 관리자 알림 설정 화면에서 **테스트 발송**으로 동작 확인

이 순서대로 하면 솔라피·카카오 채널 관리자에서 처리할 일은 모두 끝납니다.
