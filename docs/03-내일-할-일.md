# 03. 내일 할 일

로그인·회원 설정 마무리용 체크리스트입니다.

---

## 1. 로그인 "Failed to fetch" 해결

**증상:** 로그인 시 `your-project.supabase.co` / `ERR_NAME_NOT_RESOLVED` 또는 `Failed to fetch` 발생.

**원인:**  
- **다른 폴더**에서 `npm run dev`를 실행해서 `.env.local`이 안 읽힌 경우가 많음.  
- 또는 `.env.local`에 placeholder(`your-project`, `your-anon-key`)가 들어 있는 경우.  
- (`.next`는 처음부터 없을 수도 있음. 있으면 캐시 문제일 수 있어 삭제 후 재실행.)

**순서:**

1. 터미널에서 `npm run dev`가 켜져 있으면 **완전 종료** (Ctrl+C).
2. **반드시 프로젝트 폴더(원마케팅SaaS)** 로 이동한 뒤 여기서만 실행:
   ```powershell
   cd "C:\Users\yeomj\OneDrive\Desktop\원마케팅SaaS"
   npm run dev
   ```
3. `.next` 폴더가 **있다면** 삭제 후 2번 다시 실행:  
   `Remove-Item -Recurse -Force .next`  
   (없으면 2번만 하면 됨.)
4. 브라우저에서 `http://localhost:3000` 접속 후 로그인.

**확인:** `원마케팅SaaS` 폴더 안에 `.env.local`이 있고, 그 안에 **실제** Supabase URL·Anon Key가 들어 있어야 함 (placeholder `your-project` / `your-anon-key` 사용 금지).

---

## 2. Supabase "설정이 없거나 placeholder" 콘솔 에러 해결 (우선)

**증상:**  
로그인 페이지에서 콘솔에 아래 에러가 뜸. (로그인 버튼 눌렀을 때도 같은 메시지로 막힘.)

```
[Supabase] .env.local에 실제 Supabase URL과 Anon Key를 넣은 뒤, .next 폴더를 삭제하고 개발 서버를 다시 실행하세요.
```

**발생 위치:** `src\lib\supabase\client.ts` (15번 줄 근처) — `isPlaceholder`가 true로 잡혀서 `isSupabaseConfigured()`가 false 반환.

**상황:**  
`.env.local`에는 실제 URL·Anon Key가 들어 있고, `next.config.mjs`에 `env`로 `NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY` 넘기도록 이미 추가해 둠. 그런데도 **브라우저(클라이언트) 쪽에서는 여전히 값이 비어 있거나 placeholder로 인식됨.**

**내일 할 것:**  
- 클라이언트 번들에 `NEXT_PUBLIC_*` 값이 왜 안 들어가는지 확인 (Next 빌드/캐시, 실행 경로 등).  
- 필요하면 `src/lib/supabase/client.ts`에서 값을 읽는 방식 변경하거나, 다른 방법으로 브라우저에 Supabase URL/Key 전달하도록 수정.

---

## 3. Auth·프로필 다시 설정 (회원 정보 초기화)

**목표:** 기존 회원 제거 후 아래 두 계정만 사용.

| 용도 | 이메일 | UUID |
|------|--------|------|
| Admin | yeomjw0907@naver.com | 9b54abfa-7692-48a3-804d-bec6b977181d |
| 테스트(클라이언트) | test1@naver.com | ebf05114-6c34-4c20-b25f-d31496c24541 |

**순서:**

1. **Supabase Dashboard → Authentication → Users**  
   - 필요 시 기존 사용자 삭제 후, 위 두 이메일로 **Create new user** (비밀번호 설정).
2. **SQL Editor**에서 **`supabase/sql/03-seed/profiles.sql`** 전체 붙여넣고 **Run**.
   - 기존 admin/test 프로필 삭제 후 위 UUID·이메일로 다시 등록됨. 여러 번 실행 가능.

자세한 내용은 `01-먼저-할-일.md` 5·6번 참고.

---

## 4. 로그인 테스트

- **Admin:** `yeomjw0907@naver.com` + 비밀번호 → `/admin` 이동 확인.
- **테스트(클라이언트):** `test1@naver.com` + 비밀번호 → `/overview` 이동 확인.

---

## 체크리스트 요약

- [ ] **2번** Supabase placeholder 콘솔 에러 해결 (client.ts / NEXT_PUBLIC_* 브라우저 전달)
- [ ] **원마케팅SaaS 폴더에서** `npm run dev` 실행 (`.next` 있으면 삭제 후 재실행)
- [ ] 로그인 시 Failed to fetch / your-project 오류 없음
- [ ] Auth에 yeomjw0907@naver.com, test1@naver.com 사용자 생성
- [ ] `03-seed/profiles.sql` 실행
- [ ] Admin·테스트 계정으로 로그인 및 화면 확인
